<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ScreenRecord.in</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <header>
        <h1>ScreenRecord.in</h1>
        <p>Record your screen, camera, and audio ‚Äì all local, no backend.</p>
        <button id="new-recording">New Recording</button>
        <button id="toggle-sidebar">üìÅ Saved</button>
        <button id="naming-pattern-settings" title="Naming Pattern Settings">‚öôÔ∏è</button>
    </header>

    <main id="main-content">
        <section id="recording-controls" class="panel">
            <h2>Recording Controls</h2>
            <div class="config-toggles">
                <label><input type="checkbox" id="screen-toggle"> Screen Share</label>
                <label><input type="checkbox" id="camera-toggle"> Camera</label>
                <label><input type="checkbox" id="mic-toggle"> Microphone</label>
                <label><input type="checkbox" id="system-audio-toggle"> System Audio</label>
            </div>
            <div id="config-summary"></div>
            <button id="start-recording" disabled>Start Recording</button>
            <div id="pip-info" class="pip-info hidden">
                <p>üí° <strong>Keep recording active:</strong> Modern browsers pause camera/screen recording when the tab is not focused. Enable Picture-in-Picture mode to maintain continuous recording.</p>
                <button id="enable-pip" class="pip-btn">Enable Picture-in-Picture</button>
                <button id="enable-popup" class="pip-btn pip-btn-secondary">Open Popup (Fallback)</button>
            </div>
        </section>

        <section id="preview-area" class="hidden">
            <video id="preview-video" autoplay muted playsinline></video>
            <div id="recording-timer" class="recording-timer">00:00</div>
            <div id="paused-overlay" class="paused-overlay hidden">
                <span class="paused-text">‚è∏ PAUSED</span>
            </div>
            <div id="recording-controls-overlay">
                <button id="pause-recording" class="prominent" style="display: none;">‚è∏ Pause</button>
                <button id="stop-recording" class="prominent" style="display: none;">‚èπ Stop</button>
            </div>
        </section>

        <section id="error-notifications"></section>
    </main>

    <aside id="sidebar">
        <h2 id="saved-list-header">Saved Recordings</h2>
        <div id="saved-list">
            <p class="empty-state">No recordings yet. Start your first one!</p>
        </div>
        <button id="load-more-btn" style="display: none;">Load More</button>
        <button id="clear-all">Clear All</button>
        <button id="close-sidebar" class="close-sidebar">&times;</button>
    </aside>

    <div id="modal-player" class="modal hidden">
        <div class="modal-content">
            <span class="close">&times;</span>
            <video id="modal-video" controls></video>
        </div>
    </div>

    <footer>
        <div class="storage-visualization">
            <div class="storage-header">
                <span>Storage Usage</span>
                <span id="storage-info">0 MB / 0 MB</span>
            </div>
            <div class="storage-progress-container">
                <div id="storage-progress-bar" class="storage-progress-bar"></div>
            </div>
            <div id="storage-warning" class="storage-warning hidden"></div>
            <div class="storage-actions">
                <button id="download-last">Download Last</button>
                <button id="cleanup-storage">Cleanup Suggestions</button>
            </div>
            <div id="cleanup-suggestions" class="cleanup-suggestions hidden"></div>
        </div>
    </footer>

    <!-- Keyboard Shortcuts Info Icon -->
    <button id="shortcuts-info-btn" class="shortcuts-info-btn" title="Keyboard Shortcuts">‚ÑπÔ∏è</button>

    <!-- Keyboard Shortcuts Cheat Sheet Modal -->
    <div id="shortcuts-modal" class="shortcuts-modal hidden">
        <div class="shortcuts-content">
            <span class="shortcuts-close">&times;</span>
            <h2>Keyboard Shortcuts</h2>
            <div class="shortcuts-list">
                <div class="shortcut-item">
                    <kbd>Ctrl</kbd> + <kbd>Shift</kbd> + <kbd>R</kbd>
                    <span class="shortcut-desc">Start/Stop Recording</span>
                </div>
                <div class="shortcut-item">
                    <kbd>Space</kbd>
                    <span class="shortcut-desc">Pause/Resume (when recording)</span>
                </div>
                <div class="shortcut-item">
                    <kbd>Esc</kbd>
                    <span class="shortcut-desc">Cancel/Stop Recording</span>
                </div>
                <div class="shortcut-item">
                    <kbd>Ctrl</kbd> + <kbd>S</kbd>
                    <span class="shortcut-desc">Save Current Recording</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Filename Edit Modal -->
    <div id="filename-modal" class="modal hidden">
        <div class="modal-content filename-modal-content">
            <span class="filename-modal-close">&times;</span>
            <h2>Save Recording</h2>
            <div class="filename-preview">
                <label for="filename-input">Filename:</label>
                <input type="text" id="filename-input" class="filename-input" placeholder="Enter filename">
            </div>
            <div class="filename-preview-preview">
                <span class="preview-label">Preview:</span>
                <span id="filename-preview-text" class="filename-preview-text"></span>
            </div>
            <div class="filename-actions">
                <button id="filename-cancel" class="btn-secondary">Cancel</button>
                <button id="filename-save" class="btn-primary">Save</button>
            </div>
        </div>
    </div>

    <!-- Naming Pattern Settings Modal -->
    <div id="naming-pattern-modal" class="modal hidden">
        <div class="modal-content naming-pattern-modal-content">
            <span class="naming-pattern-modal-close">&times;</span>
            <h2>Naming Pattern Settings</h2>
            <div class="naming-pattern-form">
                <div class="form-group">
                    <label for="naming-pattern-select">Pattern:</label>
                    <select id="naming-pattern-select" class="naming-pattern-select">
                        <option value="detailed">Detailed - {screen}{camera} - {duration} - {date} {time}</option>
                        <option value="simple">Simple - {date} - {duration}</option>
                        <option value="minimal">Minimal - Recording {datetime}</option>
                        <option value="custom">Custom</option>
                    </select>
                </div>
                <div class="form-group custom-pattern-group hidden">
                    <label for="naming-pattern-custom">Custom Pattern:</label>
                    <input type="text" id="naming-pattern-custom" class="naming-pattern-custom" placeholder="{date} - {duration}">
                </div>
                <div class="naming-tokens">
                    <label>Available Tokens:</label>
                    <div class="token-list">
                        <span class="token" data-token="{date}">{date}</span>
                        <span class="token" data-token="{time}">{time}</span>
                        <span class="token" data-token="{datetime}">{datetime}</span>
                        <span class="token" data-token="{screen}">{screen}</span>
                        <span class="token" data-token="{camera}">{camera}</span>
                        <span class="token" data-token="{mic}">{mic}</span>
                        <span class="token" data-token="{systemAudio}">{systemAudio}</span>
                        <span class="token" data-token="{duration}">{duration}</span>
                    </div>
                </div>
                <div class="pattern-preview">
                    <label>Preview:</label>
                    <span id="pattern-preview-text" class="pattern-preview-text"></span>
                </div>
            </div>
            <div class="naming-pattern-actions">
                <button id="naming-pattern-cancel" class="btn-secondary">Cancel</button>
                <button id="naming-pattern-save" class="btn-primary">Save</button>
            </div>
        </div>
    </div>

    <script type="module" src="js/main.js"></script>
</body>
</html>